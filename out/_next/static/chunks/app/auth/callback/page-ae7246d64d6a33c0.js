(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[453],{9466:function(e,t,r){Promise.resolve().then(r.bind(r,4798))},7907:function(e,t,r){"use strict";var n=r(5313);r.o(n,"useRouter")&&r.d(t,{useRouter:function(){return n.useRouter}})},4798:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return i}});var n=r(3827),o=r(4090),s=r(7907),a=r(313),c=r(6651),u=r(2278);function i(){let e=(0,s.useRouter)(),{login:t,register:r,isAuthenticated:i}=(0,a.a)(),[l,d]=(0,o.useState)(!0),[h,m]=(0,o.useState)(!1),[f,g]=(0,o.useState)(null),[x,b]=(0,o.useState)(""),[p,y]=(0,o.useState)(""),[v,N]=(0,o.useState)("");if(i)return e.push("/dashboard"),null;let S=async n=>{n.preventDefault(),g(null),m(!0);try{if(l)await t(x,p);else{if(p.length<8){g("Пароль должен быть не менее 8 символов"),m(!1);return}if(x.length<3){g("Логин должен быть не менее 3 символов"),m(!1);return}await r(x,p,v)}e.push("/dashboard")}catch(e){g(e.message||"Произошла ошибка. Попробуйте ещё раз.")}finally{m(!1)}};return(0,n.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-background px-4",children:(0,n.jsxs)("div",{className:"w-full max-w-md",children:[(0,n.jsxs)("div",{className:"text-center mb-8",children:[(0,n.jsx)("h1",{className:"text-3xl font-serif font-bold text-foreground",children:"Shaq"}),(0,n.jsx)("p",{className:"mt-2 text-muted",children:"Создавайте красивые приглашения"})]}),(0,n.jsxs)("div",{className:"bg-white rounded-2xl shadow-sm p-8",children:[(0,n.jsxs)("div",{className:"flex mb-6 bg-background rounded-lg p-1",children:[(0,n.jsx)("button",{className:"flex-1 py-2 text-sm font-medium rounded-md transition-colors ".concat(l?"bg-white shadow-sm text-foreground":"text-muted"),onClick:()=>d(!0),children:"Вход"}),(0,n.jsx)("button",{className:"flex-1 py-2 text-sm font-medium rounded-md transition-colors ".concat(l?"text-muted":"bg-white shadow-sm text-foreground"),onClick:()=>d(!1),children:"Регистрация"})]}),(0,n.jsxs)("form",{onSubmit:S,className:"space-y-4",children:[!l&&(0,n.jsx)(u.I,{label:"Имя",type:"text",value:v,onChange:e=>N(e.target.value),placeholder:"Ваше имя",required:!0}),(0,n.jsx)(u.I,{label:"Логин",type:"text",value:x,onChange:e=>b(e.target.value),placeholder:l?"Введите логин":"Минимум 3 символа",required:!0}),(0,n.jsx)(u.I,{label:"Пароль",type:"password",value:p,onChange:e=>y(e.target.value),placeholder:l?"Введите пароль":"Минимум 8 символов",required:!0}),f&&(0,n.jsx)("p",{className:"text-sm text-red-500 text-center",children:f}),(0,n.jsx)(c.z,{type:"submit",className:"w-full",disabled:h,children:h?(0,n.jsxs)("span",{className:"flex items-center justify-center gap-2",children:[(0,n.jsx)("span",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),l?"Входим...":"Регистрируем..."]}):l?"Войти":"Зарегистрироваться"})]}),(0,n.jsx)("p",{className:"mt-6 text-center text-sm text-muted",children:l?(0,n.jsxs)(n.Fragment,{children:["Нет аккаунта?"," ",(0,n.jsx)("button",{onClick:()=>d(!1),className:"text-accent hover:underline",children:"Зарегистрироваться"})]}):(0,n.jsxs)(n.Fragment,{children:["Уже есть аккаунт?"," ",(0,n.jsx)("button",{onClick:()=>d(!0),className:"text-accent hover:underline",children:"Войти"})]})})]}),(0,n.jsx)("p",{className:"mt-6 text-center text-xs text-muted",children:(0,n.jsx)("a",{href:"/",className:"hover:text-foreground",children:"← Вернуться на главную"})})]})})}},6651:function(e,t,r){"use strict";r.d(t,{z:function(){return a}});var n=r(3827),o=r(4090),s=r(2169);let a=(0,o.forwardRef)((e,t)=>{let{className:r,variant:o="primary",size:a="md",isLoading:c,children:u,disabled:i,...l}=e;return(0,n.jsx)("button",{ref:t,className:(0,s.cn)("inline-flex items-center justify-center font-medium transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed",{primary:"bg-accent text-white hover:bg-accent-light focus:ring-accent",secondary:"bg-foreground text-background hover:bg-foreground/90 focus:ring-foreground",outline:"border-2 border-foreground text-foreground hover:bg-foreground hover:text-background focus:ring-foreground",ghost:"text-foreground hover:bg-foreground/10 focus:ring-foreground"}[o],{sm:"px-3 py-1.5 text-sm rounded-md",md:"px-4 py-2 text-base rounded-lg",lg:"px-6 py-3 text-lg rounded-xl"}[a],r),disabled:i||c,...l,children:c?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4",fill:"none",viewBox:"0 0 24 24",children:[(0,n.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,n.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Загрузка..."]}):u})});a.displayName="Button"},2278:function(e,t,r){"use strict";r.d(t,{I:function(){return a}});var n=r(3827),o=r(4090),s=r(2169);let a=(0,o.forwardRef)((e,t)=>{let{className:r,label:o,error:a,id:c,...u}=e;return(0,n.jsxs)("div",{className:"w-full",children:[o&&(0,n.jsx)("label",{htmlFor:c,className:"block text-sm font-medium text-foreground mb-1",children:o}),(0,n.jsx)("input",{ref:t,id:c,className:(0,s.cn)("w-full px-3 py-2 border border-muted-foreground/30 rounded-lg","bg-white text-foreground placeholder:text-muted","focus:outline-none focus:ring-2 focus:ring-accent focus:border-transparent","disabled:opacity-50 disabled:cursor-not-allowed",a&&"border-red-500 focus:ring-red-500",r),...u}),a&&(0,n.jsx)("p",{className:"mt-1 text-sm text-red-500",children:a})]})});a.displayName="Input"},313:function(e,t,r){"use strict";r.d(t,{a:function(){return u}});var n=r(4090),o=r(8222);function s(){return localStorage.getItem("token")}function a(e){localStorage.setItem("token",e)}function c(e){localStorage.setItem("user",JSON.stringify(e))}function u(){let[e,t]=(0,n.useState)(null),[r,u]=(0,n.useState)(!0),[i,l]=(0,n.useState)(!1);(0,n.useEffect)(()=>{let e=function(){let e=localStorage.getItem("user");if(!e)return null;try{return JSON.parse(e)}catch(e){return null}}(),r=s();e&&r&&(t(e),l(!0)),u(!1)},[]);let d=(0,n.useCallback)(async(e,r)=>{try{let n=await o.h.login(e,r);return a(n.token),c(n.user),t(n.user),l(!0),n.user}catch(e){throw console.error("Login failed:",e),e}},[]),h=(0,n.useCallback)(async(e,r,n)=>{try{let s=await o.h.register(e,r,n);return a(s.token),c(s.user),t(s.user),l(!0),s.user}catch(e){throw console.error("Registration failed:",e),e}},[]),m=(0,n.useCallback)(()=>{localStorage.removeItem("token"),localStorage.removeItem("user"),t(null),l(!1)},[]),f=(0,n.useCallback)(async()=>{if(s())try{let e=await o.h.getMe();c(e),t(e)}catch(e){console.error("Failed to refresh user:",e),m()}},[m]);return{user:e,isLoading:r,isAuthenticated:i,login:d,register:h,logout:m,refreshUser:f}}},8222:function(e,t,r){"use strict";r.d(t,{h:function(){return s}});class n extends Error{constructor(e,t){super(t),this.status=e,this.name="ApiError"}}async function o(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{requireAuth:r=!0,...o}=t,s={"Content-Type":"application/json",...o.headers};if(r){let e=localStorage.getItem("token");e&&(s.Authorization="Bearer ".concat(e))}let a=await fetch("".concat("http://localhost:8080").concat(e),{...o,headers:s});if(401===a.status)throw localStorage.removeItem("token"),localStorage.removeItem("user"),window.location.href="/",new n(401,"Unauthorized");if(!a.ok){let e=await a.json().catch(()=>({error:"An error occurred"}));throw new n(a.status,e.error||"An error occurred")}return 204===a.status?{}:a.json()}let s={register:(e,t,r)=>o("/auth/register",{method:"POST",body:JSON.stringify({login:e,password:t,name:r}),requireAuth:!1}),login:(e,t)=>o("/auth/login",{method:"POST",body:JSON.stringify({login:e,password:t}),requireAuth:!1}),getMe:()=>o("/auth/me"),createEvent:e=>o("/events",{method:"POST",body:JSON.stringify(e)}),getEvents:()=>o("/events"),getEvent:e=>o("/events/".concat(e)),updateEvent:(e,t)=>o("/events/".concat(e),{method:"PUT",body:JSON.stringify(t)}),publishEvent:e=>o("/events/".concat(e,"/publish"),{method:"PUT"}),deleteEvent:e=>o("/events/".concat(e),{method:"DELETE"}),updateSeating:(e,t)=>o("/events/".concat(e,"/seating"),{method:"PUT",body:JSON.stringify({tables:t})}),createGuest:(e,t)=>o("/events/".concat(e,"/guests"),{method:"POST",body:JSON.stringify(t)}),createGuestsBulk:(e,t)=>o("/events/".concat(e,"/guests/bulk"),{method:"POST",body:JSON.stringify({names:t})}),getGuests:e=>o("/events/".concat(e,"/guests")),updateGuest:(e,t,r)=>o("/events/".concat(e,"/guests/").concat(t),{method:"PUT",body:JSON.stringify(r)}),deleteGuest:(e,t)=>o("/events/".concat(e,"/guests/").concat(t),{method:"DELETE"}),getDashboard:e=>o("/events/".concat(e,"/dashboard")),getThemes:()=>o("/themes",{requireAuth:!1}),getTheme:e=>o("/themes/".concat(e),{requireAuth:!1}),getPublicInvitation:e=>o("/i/".concat(e),{requireAuth:!1}),getPublicInvitationWithGuest:(e,t)=>o("/i/".concat(e,"/").concat(t),{requireAuth:!1}),submitRSVP:(e,t,r)=>o("/i/".concat(e,"/").concat(t,"/rsvp"),{method:"POST",body:JSON.stringify(r),requireAuth:!1}),getPresignedUrl:(e,t)=>o("/upload/presign",{method:"POST",body:JSON.stringify({eventId:e,filename:t})}),getGuestPhotoPresignedUrl:(e,t)=>o("/i/".concat(e,"/photos/upload"),{method:"POST",body:JSON.stringify({filename:t}),requireAuth:!1}),getGuestPhotos:e=>o("/i/".concat(e,"/photos"),{requireAuth:!1})}},2169:function(e,t,r){"use strict";r.d(t,{cn:function(){return s},kU:function(){return u},p6:function(){return a},sS:function(){return c},vQ:function(){return i}});var n=r(3167),o=r(1367);function s(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,o.m6)((0,n.W)(t))}function a(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"ru-RU";return new Date(e).toLocaleDateString(t,{day:"numeric",month:"long",year:"numeric"})}function c(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"12:00",[r,n,o]=e.split("-").map(Number),[s,a]=t.split(":").map(Number),c=new Date(r,n-1,o,s,a),u=new Date,i=c.getTime()-u.getTime();return i<=0?{days:0,hours:0,minutes:0,seconds:0,isPast:!0}:{days:Math.floor(i/864e5),hours:Math.floor(i%864e5/36e5),minutes:Math.floor(i%36e5/6e4),seconds:Math.floor(i%6e4/1e3),isPast:!1}}function u(e,t){let r=encodeURIComponent("Құрметті ".concat(t,"!\n\nСізді біздің тойға шақырамыз!\n\n").concat("https://shaq.kz".concat(e)));return"https://wa.me/?text=".concat(r)}function i(e){return navigator.clipboard.writeText(e)}}},function(e){e.O(0,[150,971,69,744],function(){return e(e.s=9466)}),_N_E=e.O()}]);